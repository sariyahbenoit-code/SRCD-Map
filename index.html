<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SRCD 3D Map</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">

<link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0-beta.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0-beta.1/mapbox-gl.js"></script>

<script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.160.0/examples/js/loaders/GLTFLoader.js"></script>

<link rel="stylesheet" href="style.css">
</head>

<body>
<div id="map"></div>
<canvas id="surfaceCanvas"></canvas>

<script>
mapboxgl.accessToken = "pk.eyJ1Ijoic25iZW5vaSIsImEiOiJjbWg5Y2IweTAwbnRzMm5xMXZrNnFnbmY5In0.Lza9yPTlMhbHE5zHNRb1aA";

const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/snbenoi/cmhjgr9hh000001rcf6cy38p0",
    center: [-122.5125, 37.9679],
    zoom: 18,
    pitch: 60,
    bearing: 0,
    antialias: true
});

map.addControl(
    new mapboxgl.NavigationControl({
        visualizePitch: true,
        showCompass: true
    }),
    "top-right"
);

map.on("load", () => {
    const corners = [
        [-122.537464, 37.984078],
        [-122.477353, 37.984108],
        [-122.477370, 37.952203],
        [-122.537475, 37.952208]
    ];

    const underUrl = "https://raw.githubusercontent.com/sariyahbenoit-code/SRCD-Map/main/assets/images/SFCD%20underground.jpg";
    const surfaceUrl = "https://raw.githubusercontent.com/sariyahbenoit-code/SRCD-Map/main/assets/images/SRCD%20surface.jpg";

    map.addSource("under-image", {
        type: "image",
        url: underUrl,
        coordinates: corners
    });

    map.addLayer({
        id: "under-layer",
        type: "raster",
        source: "under-image",
        paint: { "raster-opacity": 1 }
    });

    const surfaceCanvas = document.getElementById("surfaceCanvas");
    const ctx = surfaceCanvas.getContext("2d", { alpha: true });

    const surfaceImg = new Image();
    surfaceImg.
